---

- name: Create Grafana dashboards
  kubernetes.core.k8s:
    state: present
    kubeconfig: "{{ kubeconfig }}"
    proxy: "{{ proxy_url | default(omit, true) }}"
    proxy_headers: "{{ proxy_headers | default(omit, true) }}"
    template: "grafana-dashboard.yml.j2"
    namespace: "{{ item.namespace | default('monitoring') }}"
  loop: "{{ kubernetes_prometheus_dashboards }}"
  loop_control:
    label: "{{ item.namespace | default('monitoring') }}"
